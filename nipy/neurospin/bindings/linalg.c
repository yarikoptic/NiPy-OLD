/* Generated by Cython 0.10.3 on Sat Feb 28 00:24:25 2009 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#if PY_VERSION_HEX < 0x02040000
  #define METH_COEXIST 0
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   PyInt_AsLong(o)
  #define PyNumber_Index(o)    PyNumber_Int(o)
  #define PyIndex_Check(o)     PyNumber_Check(o)
#endif
#if PY_VERSION_HEX < 0x02060000
  #define Py_REFCNT(ob) (((PyObject*)(ob))->ob_refcnt)
  #define Py_TYPE(ob)   (((PyObject*)(ob))->ob_type)
  #define Py_SIZE(ob)   (((PyVarObject*)(ob))->ob_size)
  #define PyVarObject_HEAD_INIT(type, size) \
          PyObject_HEAD_INIT(type) size,
  #define PyType_Modified(t)

  typedef struct {
       void *buf;
       PyObject *obj;
       Py_ssize_t len;
       Py_ssize_t itemsize;
       int readonly;
       int ndim;
       char *format;
       Py_ssize_t *shape;
       Py_ssize_t *strides;
       Py_ssize_t *suboffsets;
       void *internal;
  } Py_buffer;

  #define PyBUF_SIMPLE 0
  #define PyBUF_WRITABLE 0x0001
  #define PyBUF_LOCK 0x0002
  #define PyBUF_FORMAT 0x0004
  #define PyBUF_ND 0x0008
  #define PyBUF_STRIDES (0x0010 | PyBUF_ND)
  #define PyBUF_C_CONTIGUOUS (0x0020 | PyBUF_STRIDES)
  #define PyBUF_F_CONTIGUOUS (0x0040 | PyBUF_STRIDES)
  #define PyBUF_ANY_CONTIGUOUS (0x0080 | PyBUF_STRIDES)
  #define PyBUF_INDIRECT (0x0100 | PyBUF_STRIDES)

#endif
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#if (PY_VERSION_HEX < 0x02060000) || (PY_MAJOR_VERSION >= 3)
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyString_Type                PyBytes_Type
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define PyBytes_Type                 PyString_Type
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyMethod_New(func, self, klass) PyInstanceMethod_New(func)
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
#else
  #define _USE_MATH_DEFINES
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#include <math.h>
#define __PYX_HAVE_API__fff2__bindings__linalg
#include "numpy/arrayobject.h"
#include "fff_vector.h"
#include "fff_matrix.h"
#include "fff_base.h"
#include "fff_array.h"
#include "randomkit.h"
#include "fffpy.h"
#include "fff_blas.h"


#ifdef __GNUC__
#define INLINE __inline__
#elif _WIN32
#define INLINE __inline
#else
#define INLINE 
#endif

typedef struct {PyObject **p; char *s; long n; char is_unicode; char intern; char is_identifier;} __Pyx_StringTabEntry; /*proto*/



static int __pyx_skip_dispatch = 0;


/* Type Conversion Predeclarations */

#if PY_MAJOR_VERSION < 3
#define __Pyx_PyBytes_FromString PyString_FromString
#define __Pyx_PyBytes_AsString   PyString_AsString
#else
#define __Pyx_PyBytes_FromString PyBytes_FromString
#define __Pyx_PyBytes_AsString   PyBytes_AsString
#endif

#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static INLINE int __Pyx_PyObject_IsTrue(PyObject* x);
static INLINE PY_LONG_LONG __pyx_PyInt_AsLongLong(PyObject* x);
static INLINE unsigned PY_LONG_LONG __pyx_PyInt_AsUnsignedLongLong(PyObject* x);
static INLINE Py_ssize_t __pyx_PyIndex_AsSsize_t(PyObject* b);

#define __pyx_PyInt_AsLong(x) (PyInt_CheckExact(x) ? PyInt_AS_LONG(x) : PyInt_AsLong(x))
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))

static INLINE unsigned char __pyx_PyInt_unsigned_char(PyObject* x);
static INLINE unsigned short __pyx_PyInt_unsigned_short(PyObject* x);
static INLINE char __pyx_PyInt_char(PyObject* x);
static INLINE short __pyx_PyInt_short(PyObject* x);
static INLINE int __pyx_PyInt_int(PyObject* x);
static INLINE long __pyx_PyInt_long(PyObject* x);
static INLINE signed char __pyx_PyInt_signed_char(PyObject* x);
static INLINE signed short __pyx_PyInt_signed_short(PyObject* x);
static INLINE signed int __pyx_PyInt_signed_int(PyObject* x);
static INLINE signed long __pyx_PyInt_signed_long(PyObject* x);
static INLINE long double __pyx_PyInt_long_double(PyObject* x);
#ifdef __GNUC__
/* Test for GCC > 2.95 */
#if __GNUC__ > 2 ||               (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)) 
#define likely(x)   __builtin_expect(!!(x), 1)
#define unlikely(x) __builtin_expect(!!(x), 0)
#else /* __GNUC__ > 2 ... */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ > 2 ... */
#else /* __GNUC__ */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ */
    
static PyObject *__pyx_m;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;
static const char **__pyx_f;

static char __pyx_mdoc[] = "\nPython access to core fff functions written in C. This module is\nmainly used for unitary tests.\n\nAuthor: Alexis Roche, 2008.\n";

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name, PyObject* kw_name); /*proto*/

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found); /*proto*/

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,     const char* function_name); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, long size);  /*proto*/

static PyObject *__Pyx_ImportModule(const char *name); /*proto*/

static void __Pyx_AddTraceback(const char *funcname); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

/* Type declarations */

typedef unsigned long __pyx_t_4fff2_8bindings_6linalg_size_t;
/* Module declarations from numpy */

/* Module declarations from fff2.bindings.linalg */

static PyTypeObject *__pyx_ptype_4fff2_8bindings_6linalg_dtype = 0;
static PyTypeObject *__pyx_ptype_4fff2_8bindings_6linalg_ndarray = 0;
static PyTypeObject *__pyx_ptype_4fff2_8bindings_6linalg_flatiter = 0;
static PyTypeObject *__pyx_ptype_4fff2_8bindings_6linalg_broadcast = 0;
static CBLAS_TRANSPOSE_t __pyx_f_4fff2_8bindings_6linalg_flag_transpose(int); /*proto*/
static CBLAS_UPLO_t __pyx_f_4fff2_8bindings_6linalg_flag_uplo(int); /*proto*/
static CBLAS_DIAG_t __pyx_f_4fff2_8bindings_6linalg_flag_diag(int); /*proto*/
static CBLAS_SIDE_t __pyx_f_4fff2_8bindings_6linalg_flag_side(int); /*proto*/


/* Implementation of fff2.bindings.linalg */
static char __pyx_k_1[] = "0.1";
static char __pyx_k_X[] = "X";
static PyObject *__pyx_kp_X;
static char __pyx_k_i[] = "i";
static PyObject *__pyx_kp_i;
static char __pyx_k_a[] = "a";
static PyObject *__pyx_kp_a;
static char __pyx_k_Y[] = "Y";
static PyObject *__pyx_kp_Y;
static char __pyx_k_m[] = "m";
static PyObject *__pyx_kp_m;
static char __pyx_k_fixed[] = "fixed";
static PyObject *__pyx_kp_fixed;
static char __pyx_k_r[] = "r";
static PyObject *__pyx_kp_r;
static char __pyx_k_interp[] = "interp";
static PyObject *__pyx_kp_interp;
static char __pyx_k_A[] = "A";
static PyObject *__pyx_kp_A;
static char __pyx_k_j[] = "j";
static PyObject *__pyx_kp_j;
static char __pyx_k_B[] = "B";
static PyObject *__pyx_kp_B;
static char __pyx_k_alpha[] = "alpha";
static PyObject *__pyx_kp_alpha;
static char __pyx_k_TransA[] = "TransA";
static PyObject *__pyx_kp_TransA;
static char __pyx_k_TransB[] = "TransB";
static PyObject *__pyx_kp_TransB;
static char __pyx_k_beta[] = "beta";
static PyObject *__pyx_kp_beta;
static char __pyx_k_C[] = "C";
static PyObject *__pyx_kp_C;
static char __pyx_k_Side[] = "Side";
static PyObject *__pyx_kp_Side;
static char __pyx_k_Uplo[] = "Uplo";
static PyObject *__pyx_kp_Uplo;
static char __pyx_k_Diag[] = "Diag";
static PyObject *__pyx_kp_Diag;
static char __pyx_k_Trans[] = "Trans";
static PyObject *__pyx_kp_Trans;
static char __pyx_k___version__[] = "__version__";
static PyObject *__pyx_kp___version__;
static char __pyx_k_numpy[] = "numpy";
static PyObject *__pyx_kp_numpy;
static char __pyx_k_np[] = "np";
static PyObject *__pyx_kp_np;
static PyObject *__pyx_kp_1;

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":91
 * 
 * ## fff_vector.h
 * def vector_get(X, size_t i):             # <<<<<<<<<<<<<<
 *     """
 *     Get i-th element.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_get(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_get[] = "\n    Get i-th element.\n    xi = vector_get(x, i)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_get(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  __pyx_t_4fff2_8bindings_6linalg_size_t __pyx_v_i;
  fff_vector *__pyx_v_x;
  double __pyx_v_xi;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_i,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_i);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_get", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_get") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_i = PyInt_AsUnsignedLongMask(values[1]); if (unlikely((__pyx_v_i == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_i = PyInt_AsUnsignedLongMask(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_i == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_get", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_get");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":98
 *     cdef fff_vector* x
 *     cdef double xi
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     xi = fff_vector_get(x, i)
 *     fff_vector_delete(x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":99
 *     cdef double xi
 *     x = fff_vector_fromPyArray(X)
 *     xi = fff_vector_get(x, i)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     return xi
 */
  __pyx_v_xi = fff_vector_get(__pyx_v_x, __pyx_v_i);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":100
 *     x = fff_vector_fromPyArray(X)
 *     xi = fff_vector_get(x, i)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     return xi
 * 
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":101
 *     xi = fff_vector_get(x, i)
 *     fff_vector_delete(x)
 *     return xi             # <<<<<<<<<<<<<<
 * 
 * def vector_set(X, size_t i, double a):
 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_xi); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_get");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":103
 *     return xi
 * 
 * def vector_set(X, size_t i, double a):             # <<<<<<<<<<<<<<
 *     """
 *     Set i-th element.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_set(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_set[] = "\n    Set i-th element.\n    vector_set(x, i, a)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_set(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  __pyx_t_4fff2_8bindings_6linalg_size_t __pyx_v_i;
  double __pyx_v_a;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  PyObject *__pyx_v_Y;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_i,&__pyx_kp_a,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[3] = {0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_i);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_set", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_a);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_set", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_set") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_i = PyInt_AsUnsignedLongMask(values[1]); if (unlikely((__pyx_v_i == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_a = __pyx_PyFloat_AsDouble(values[2]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_i = PyInt_AsUnsignedLongMask(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_i == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_a = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_set", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_set");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Y = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":109
 *     """
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":110
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(y, x)
 *     fff_vector_set(y, i, a)
 */
  __pyx_v_y = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":111
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)             # <<<<<<<<<<<<<<
 *     fff_vector_set(y, i, a)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_y, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":112
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 *     fff_vector_set(y, i, a)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 */
  fff_vector_set(__pyx_v_y, __pyx_v_i, __pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":113
 *     fff_vector_memcpy(y, x)
 *     fff_vector_set(y, i, a)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     Y = fff_vector_toPyArray(y)
 *     return Y
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":114
 *     fff_vector_set(y, i, a)
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)             # <<<<<<<<<<<<<<
 *     return Y
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_y)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Y);
  __pyx_v_Y = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":115
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 *     return Y             # <<<<<<<<<<<<<<
 * 
 * def vector_set_all(X, double a):
 */
  Py_INCREF(__pyx_v_Y);
  __pyx_r = __pyx_v_Y;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_set");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Y);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":117
 *     return Y
 * 
 * def vector_set_all(X, double a):             # <<<<<<<<<<<<<<
 *     """
 *     Set to a constant value.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_set_all(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_set_all[] = "\n    Set to a constant value.\n    vector_set_all(x, a)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_set_all(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  double __pyx_v_a;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  PyObject *__pyx_v_Y;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_a,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_a);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_set_all", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_set_all") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_a = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_a = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_set_all", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_set_all");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Y = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":123
 *     """
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":124
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(y, x)
 *     fff_vector_set_all(y, a)
 */
  __pyx_v_y = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":125
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)             # <<<<<<<<<<<<<<
 *     fff_vector_set_all(y, a)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_y, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":126
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 *     fff_vector_set_all(y, a)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 */
  fff_vector_set_all(__pyx_v_y, __pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":127
 *     fff_vector_memcpy(y, x)
 *     fff_vector_set_all(y, a)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     Y = fff_vector_toPyArray(y)
 *     return Y
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":128
 *     fff_vector_set_all(y, a)
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)             # <<<<<<<<<<<<<<
 *     return Y
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_y)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Y);
  __pyx_v_Y = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":129
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 *     return Y             # <<<<<<<<<<<<<<
 * 
 * def vector_scale(X, double a):
 */
  Py_INCREF(__pyx_v_Y);
  __pyx_r = __pyx_v_Y;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_set_all");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Y);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":131
 *     return Y
 * 
 * def vector_scale(X, double a):             # <<<<<<<<<<<<<<
 *     """
 *     Multiply by a constant value.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_scale(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_scale[] = "\n    Multiply by a constant value.\n    y = vector_scale(x, a)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_scale(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  double __pyx_v_a;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  PyObject *__pyx_v_Y;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_a,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_a);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_scale", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_scale") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_a = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_a = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_scale", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_scale");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Y = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":137
 *     """
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":138
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(y, x)
 *     fff_vector_scale(y, a)
 */
  __pyx_v_y = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":139
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)             # <<<<<<<<<<<<<<
 *     fff_vector_scale(y, a)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_y, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":140
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 *     fff_vector_scale(y, a)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 */
  fff_vector_scale(__pyx_v_y, __pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":141
 *     fff_vector_memcpy(y, x)
 *     fff_vector_scale(y, a)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     Y = fff_vector_toPyArray(y)
 *     return Y
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":142
 *     fff_vector_scale(y, a)
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)             # <<<<<<<<<<<<<<
 *     return Y
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_y)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Y);
  __pyx_v_Y = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":143
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 *     return Y             # <<<<<<<<<<<<<<
 * 
 * def vector_add_constant(X, double a):
 */
  Py_INCREF(__pyx_v_Y);
  __pyx_r = __pyx_v_Y;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_scale");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Y);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":145
 *     return Y
 * 
 * def vector_add_constant(X, double a):             # <<<<<<<<<<<<<<
 *     """
 *     Add a constant value.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_add_constant(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_add_constant[] = "\n    Add a constant value.\n    y = vector_add_constant(x, a)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_add_constant(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  double __pyx_v_a;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  PyObject *__pyx_v_Y;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_a,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_a);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_add_constant", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_add_constant") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_a = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_a = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_add_constant", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_add_constant");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Y = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":151
 *     """
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":152
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(y, x)
 *     fff_vector_add_constant(y, a)
 */
  __pyx_v_y = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":153
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)             # <<<<<<<<<<<<<<
 *     fff_vector_add_constant(y, a)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_y, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":154
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 *     fff_vector_add_constant(y, a)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 */
  fff_vector_add_constant(__pyx_v_y, __pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":155
 *     fff_vector_memcpy(y, x)
 *     fff_vector_add_constant(y, a)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     Y = fff_vector_toPyArray(y)
 *     return Y
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":156
 *     fff_vector_add_constant(y, a)
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)             # <<<<<<<<<<<<<<
 *     return Y
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_y)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Y);
  __pyx_v_Y = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":157
 *     fff_vector_delete(x)
 *     Y = fff_vector_toPyArray(y)
 *     return Y             # <<<<<<<<<<<<<<
 * 
 * def vector_add(X, Y):
 */
  Py_INCREF(__pyx_v_Y);
  __pyx_r = __pyx_v_Y;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_add_constant");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Y);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":159
 *     return Y
 * 
 * def vector_add(X, Y):             # <<<<<<<<<<<<<<
 *     """
 *     Add two vectors.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_add(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_add[] = "\n    Add two vectors.\n    z = vector_add(x, y)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_add(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_Y = 0;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  fff_vector *__pyx_v_z;
  PyObject *__pyx_v_Z;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_Y,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Y);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_add", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_add") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_Y = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_Y = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_add", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_add");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Z = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":165
 *     """
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":166
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)             # <<<<<<<<<<<<<<
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_Y, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_y = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_Y));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":167
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(z, x)
 *     fff_vector_add(z, y)
 */
  __pyx_v_z = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":168
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)             # <<<<<<<<<<<<<<
 *     fff_vector_add(z, y)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_z, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":169
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 *     fff_vector_add(z, y)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 */
  fff_vector_add(__pyx_v_z, __pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":170
 *     fff_vector_memcpy(z, x)
 *     fff_vector_add(z, y)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":171
 *     fff_vector_add(z, y)
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)             # <<<<<<<<<<<<<<
 *     Z = fff_vector_toPyArray(z)
 *     return Z
 */
  fff_vector_delete(__pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":172
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)             # <<<<<<<<<<<<<<
 *     return Z
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_z)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Z);
  __pyx_v_Z = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":173
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 *     return Z             # <<<<<<<<<<<<<<
 * 
 * def vector_sub(X, Y):
 */
  Py_INCREF(__pyx_v_Z);
  __pyx_r = __pyx_v_Z;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_add");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Z);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":175
 *     return Z
 * 
 * def vector_sub(X, Y):             # <<<<<<<<<<<<<<
 *     """
 *     Substract two vectors: x - y
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_sub(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_sub[] = "\n    Substract two vectors: x - y\n    z = vector_sub(x, y)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_sub(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_Y = 0;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  fff_vector *__pyx_v_z;
  PyObject *__pyx_v_Z;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_Y,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Y);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_sub", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_sub") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_Y = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_Y = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_sub", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_sub");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Z = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":181
 *     """
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":182
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)             # <<<<<<<<<<<<<<
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_Y, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_y = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_Y));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":183
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(z, x)
 *     fff_vector_sub(z, y)
 */
  __pyx_v_z = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":184
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)             # <<<<<<<<<<<<<<
 *     fff_vector_sub(z, y)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_z, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":185
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 *     fff_vector_sub(z, y)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 */
  fff_vector_sub(__pyx_v_z, __pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":186
 *     fff_vector_memcpy(z, x)
 *     fff_vector_sub(z, y)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":187
 *     fff_vector_sub(z, y)
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)             # <<<<<<<<<<<<<<
 *     Z = fff_vector_toPyArray(z)
 *     return Z
 */
  fff_vector_delete(__pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":188
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)             # <<<<<<<<<<<<<<
 *     return Z
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_z)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Z);
  __pyx_v_Z = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":189
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 *     return Z             # <<<<<<<<<<<<<<
 * 
 * def vector_mul(X, Y):
 */
  Py_INCREF(__pyx_v_Z);
  __pyx_r = __pyx_v_Z;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_sub");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Z);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":191
 *     return Z
 * 
 * def vector_mul(X, Y):             # <<<<<<<<<<<<<<
 *     """
 *     Element-wise multiplication.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_mul(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_mul[] = "\n    Element-wise multiplication.\n    z = vector_mul(x, y)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_mul(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_Y = 0;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  fff_vector *__pyx_v_z;
  PyObject *__pyx_v_Z;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_Y,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Y);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_mul", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_mul") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_Y = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_Y = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_mul", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_mul");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Z = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":197
 *     """
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":198
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)             # <<<<<<<<<<<<<<
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_Y, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_y = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_Y));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":199
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(z, x)
 *     fff_vector_mul(z, y)
 */
  __pyx_v_z = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":200
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)             # <<<<<<<<<<<<<<
 *     fff_vector_mul(z, y)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_z, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":201
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 *     fff_vector_mul(z, y)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 */
  fff_vector_mul(__pyx_v_z, __pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":202
 *     fff_vector_memcpy(z, x)
 *     fff_vector_mul(z, y)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":203
 *     fff_vector_mul(z, y)
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)             # <<<<<<<<<<<<<<
 *     Z = fff_vector_toPyArray(z)
 *     return Z
 */
  fff_vector_delete(__pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":204
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)             # <<<<<<<<<<<<<<
 *     return Z
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_z)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Z);
  __pyx_v_Z = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":205
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 *     return Z             # <<<<<<<<<<<<<<
 * 
 * def vector_div(X, Y):
 */
  Py_INCREF(__pyx_v_Z);
  __pyx_r = __pyx_v_Z;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_mul");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Z);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":207
 *     return Z
 * 
 * def vector_div(X, Y):             # <<<<<<<<<<<<<<
 *     """
 *     Element-wise division.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_div(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_div[] = "\n    Element-wise division.\n    z = vector_div(x, y)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_div(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_Y = 0;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  fff_vector *__pyx_v_z;
  PyObject *__pyx_v_Z;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_Y,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Y);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_div", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_div") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_Y = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_Y = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_div", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_div");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Z = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":213
 *     """
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":214
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)             # <<<<<<<<<<<<<<
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_Y, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_y = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_Y));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":215
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(z, x)
 *     fff_vector_mul(z, y)
 */
  __pyx_v_z = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":216
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)             # <<<<<<<<<<<<<<
 *     fff_vector_mul(z, y)
 *     fff_vector_delete(x)
 */
  fff_vector_memcpy(__pyx_v_z, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":217
 *     z = fff_vector_new(x.size)
 *     fff_vector_memcpy(z, x)
 *     fff_vector_mul(z, y)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 */
  fff_vector_mul(__pyx_v_z, __pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":218
 *     fff_vector_memcpy(z, x)
 *     fff_vector_mul(z, y)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":219
 *     fff_vector_mul(z, y)
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)             # <<<<<<<<<<<<<<
 *     Z = fff_vector_toPyArray(z)
 *     return Z
 */
  fff_vector_delete(__pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":220
 *     fff_vector_delete(x)
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)             # <<<<<<<<<<<<<<
 *     return Z
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_z)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Z);
  __pyx_v_Z = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":221
 *     fff_vector_delete(y)
 *     Z = fff_vector_toPyArray(z)
 *     return Z             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_Z);
  __pyx_r = __pyx_v_Z;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_div");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Z);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":224
 * 
 * 
 * def vector_sum(X):             # <<<<<<<<<<<<<<
 *     """
 *     Sum up array elements.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_sum(PyObject *__pyx_self, PyObject *__pyx_v_X); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_sum[] = "\n    Sum up array elements.\n    s = vector_sum(x)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_sum(PyObject *__pyx_self, PyObject *__pyx_v_X) {
  fff_vector *__pyx_v_x;
  long double __pyx_v_s;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_self = __pyx_self;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":231
 *     cdef fff_vector* x
 *     cdef long double s
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     s = fff_vector_sum(x)
 *     fff_vector_delete(x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":232
 *     cdef long double s
 *     x = fff_vector_fromPyArray(X)
 *     s = fff_vector_sum(x)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     return s
 */
  __pyx_v_s = fff_vector_sum(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":233
 *     x = fff_vector_fromPyArray(X)
 *     s = fff_vector_sum(x)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     return s
 * 
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":234
 *     s = fff_vector_sum(x)
 *     fff_vector_delete(x)
 *     return s             # <<<<<<<<<<<<<<
 * 
 * def vector_ssd(X, double m=0, int fixed=1):
 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_sum");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":236
 *     return s
 * 
 * def vector_ssd(X, double m=0, int fixed=1):             # <<<<<<<<<<<<<<
 *     """
 *     (Minimal) sum of squared differences.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_ssd(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_ssd[] = "\n    (Minimal) sum of squared differences.\n    s = vector_ssd(x, m=0, fixed=1)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_ssd(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  double __pyx_v_m;
  int __pyx_v_fixed;
  fff_vector *__pyx_v_x;
  long double __pyx_v_s;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_m,&__pyx_kp_fixed,0};
  __pyx_self = __pyx_self;
  __pyx_v_m = ((double)0);
  __pyx_v_fixed = 1;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[3] = {0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_ssd") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    if (values[1]) {
      __pyx_v_m = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[2]) {
      __pyx_v_fixed = __pyx_PyInt_int(values[2]); if (unlikely((__pyx_v_fixed == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
  } else {
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: __pyx_v_fixed = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_fixed == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  2: __pyx_v_m = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_ssd", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_ssd");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":243
 *     cdef fff_vector* x
 *     cdef long double s
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     s = fff_vector_ssd(x, &m, fixed)
 *     fff_vector_delete(x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":244
 *     cdef long double s
 *     x = fff_vector_fromPyArray(X)
 *     s = fff_vector_ssd(x, &m, fixed)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     return s
 */
  __pyx_v_s = fff_vector_ssd(__pyx_v_x, (&__pyx_v_m), __pyx_v_fixed);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":245
 *     x = fff_vector_fromPyArray(X)
 *     s = fff_vector_ssd(x, &m, fixed)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     return s
 * 
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":246
 *     s = fff_vector_ssd(x, &m, fixed)
 *     fff_vector_delete(x)
 *     return s             # <<<<<<<<<<<<<<
 * 
 * def vector_sad(X, double m=0):
 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_ssd");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":248
 *     return s
 * 
 * def vector_sad(X, double m=0):             # <<<<<<<<<<<<<<
 *     """
 *     Sum of absolute differences.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_sad(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_sad[] = "\n    Sum of absolute differences.\n    s = vector_sad(x, m=0)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_sad(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  double __pyx_v_m;
  fff_vector *__pyx_v_x;
  long double __pyx_v_s;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_m,0};
  __pyx_self = __pyx_self;
  __pyx_v_m = ((double)0);
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_sad") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    if (values[1]) {
      __pyx_v_m = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
  } else {
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: __pyx_v_m = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  1: __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_sad", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_sad");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":255
 *     cdef fff_vector* x
 *     cdef long double s
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     s = fff_vector_sad(x, m)
 *     fff_vector_delete(x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":256
 *     cdef long double s
 *     x = fff_vector_fromPyArray(X)
 *     s = fff_vector_sad(x, m)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     return s
 */
  __pyx_v_s = fff_vector_sad(__pyx_v_x, __pyx_v_m);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":257
 *     x = fff_vector_fromPyArray(X)
 *     s = fff_vector_sad(x, m)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     return s
 * 
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":258
 *     s = fff_vector_sad(x, m)
 *     fff_vector_delete(x)
 *     return s             # <<<<<<<<<<<<<<
 * 
 * def vector_median(X):
 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_sad");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":260
 *     return s
 * 
 * def vector_median(X):             # <<<<<<<<<<<<<<
 *     """
 *     Median.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_median(PyObject *__pyx_self, PyObject *__pyx_v_X); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_median[] = "\n    Median.\n    m = vector_median(x)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_median(PyObject *__pyx_self, PyObject *__pyx_v_X) {
  fff_vector *__pyx_v_x;
  double __pyx_v_m;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_self = __pyx_self;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":267
 *     cdef fff_vector* x
 *     cdef double m
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     m = fff_vector_median(x)
 *     fff_vector_delete(x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":268
 *     cdef double m
 *     x = fff_vector_fromPyArray(X)
 *     m = fff_vector_median(x)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     return m
 */
  __pyx_v_m = fff_vector_median(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":269
 *     x = fff_vector_fromPyArray(X)
 *     m = fff_vector_median(x)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     return m
 * 
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":270
 *     m = fff_vector_median(x)
 *     fff_vector_delete(x)
 *     return m             # <<<<<<<<<<<<<<
 * 
 * def vector_quantile(X, double r, int interp):
 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_m); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_median");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":272
 *     return m
 * 
 * def vector_quantile(X, double r, int interp):             # <<<<<<<<<<<<<<
 *     """
 *     Quantile.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_quantile(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_vector_quantile[] = "\n    Quantile.\n    q = vector_quantile(x, r=0.5, interp=1)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_vector_quantile(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  double __pyx_v_r;
  int __pyx_v_interp;
  fff_vector *__pyx_v_x;
  double __pyx_v_q;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_r,&__pyx_kp_interp,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[3] = {0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_r);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_quantile", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_interp);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("vector_quantile", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "vector_quantile") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_r = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_interp = __pyx_PyInt_int(values[2]); if (unlikely((__pyx_v_interp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_r = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_interp = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_interp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vector_quantile", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_quantile");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":279
 *     cdef fff_vector* x
 *     cdef double q
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     q = fff_vector_quantile(x, r, interp)
 *     fff_vector_delete(x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":280
 *     cdef double q
 *     x = fff_vector_fromPyArray(X)
 *     q = fff_vector_quantile(x, r, interp)             # <<<<<<<<<<<<<<
 *     fff_vector_delete(x)
 *     return q
 */
  __pyx_v_q = fff_vector_quantile(__pyx_v_x, __pyx_v_r, __pyx_v_interp);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":281
 *     x = fff_vector_fromPyArray(X)
 *     q = fff_vector_quantile(x, r, interp)
 *     fff_vector_delete(x)             # <<<<<<<<<<<<<<
 *     return q
 * 
 */
  fff_vector_delete(__pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":282
 *     q = fff_vector_quantile(x, r, interp)
 *     fff_vector_delete(x)
 *     return q             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_q); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.vector_quantile");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":286
 * 
 * ## fff_matrix.h
 * def matrix_get(A, size_t i, size_t j):             # <<<<<<<<<<<<<<
 *     """
 *     Get (i,j) element.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_matrix_get(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_matrix_get[] = "\n    Get (i,j) element.\n    aij = matrix_get(A, i, j)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_matrix_get(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_A = 0;
  __pyx_t_4fff2_8bindings_6linalg_size_t __pyx_v_i;
  __pyx_t_4fff2_8bindings_6linalg_size_t __pyx_v_j;
  fff_matrix *__pyx_v_a;
  double __pyx_v_aij;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_A,&__pyx_kp_i,&__pyx_kp_j,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[3] = {0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_i);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("matrix_get", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_j);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("matrix_get", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "matrix_get") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_A = values[0];
    __pyx_v_i = PyInt_AsUnsignedLongMask(values[1]); if (unlikely((__pyx_v_i == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_j = PyInt_AsUnsignedLongMask(values[2]); if (unlikely((__pyx_v_j == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_i = PyInt_AsUnsignedLongMask(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_i == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_j = PyInt_AsUnsignedLongMask(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_j == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("matrix_get", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.matrix_get");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":293
 *     cdef fff_matrix* a
 *     cdef double aij
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     aij = fff_matrix_get(a, i, j)
 *     fff_matrix_delete(a)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":294
 *     cdef double aij
 *     a = fff_matrix_fromPyArray(A)
 *     aij = fff_matrix_get(a, i, j)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     return aij
 */
  __pyx_v_aij = fff_matrix_get(__pyx_v_a, __pyx_v_i, __pyx_v_j);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":295
 *     a = fff_matrix_fromPyArray(A)
 *     aij = fff_matrix_get(a, i, j)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     return aij
 * 
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":296
 *     aij = fff_matrix_get(a, i, j)
 *     fff_matrix_delete(a)
 *     return aij             # <<<<<<<<<<<<<<
 * 
 * def matrix_transpose(A):
 */
  __pyx_1 = PyFloat_FromDouble(__pyx_v_aij); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.matrix_get");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":298
 *     return aij
 * 
 * def matrix_transpose(A):             # <<<<<<<<<<<<<<
 *     """
 *     Transpose a matrix.
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_matrix_transpose(PyObject *__pyx_self, PyObject *__pyx_v_A); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_matrix_transpose[] = "\n    Transpose a matrix.\n    B = matrix_transpose(A)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_matrix_transpose(PyObject *__pyx_self, PyObject *__pyx_v_A) {
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_b;
  PyObject *__pyx_v_B;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_self = __pyx_self;
  __pyx_v_B = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":304
 *     """
 *     cdef fff_matrix *a, *b
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     b = fff_matrix_new(a.size2, a.size1)
 *     fff_matrix_transpose(b, a)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":305
 *     cdef fff_matrix *a, *b
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_new(a.size2, a.size1)             # <<<<<<<<<<<<<<
 *     fff_matrix_transpose(b, a)
 *     fff_matrix_delete(a)
 */
  __pyx_v_b = fff_matrix_new(__pyx_v_a->size2, __pyx_v_a->size1);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":306
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_new(a.size2, a.size1)
 *     fff_matrix_transpose(b, a)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     B = fff_matrix_toPyArray(b)
 */
  fff_matrix_transpose(__pyx_v_b, __pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":307
 *     b = fff_matrix_new(a.size2, a.size1)
 *     fff_matrix_transpose(b, a)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     B = fff_matrix_toPyArray(b)
 *     return B
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":308
 *     fff_matrix_transpose(b, a)
 *     fff_matrix_delete(a)
 *     B = fff_matrix_toPyArray(b)             # <<<<<<<<<<<<<<
 *     return B
 * 
 */
  __pyx_1 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_b)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_B);
  __pyx_v_B = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":309
 *     fff_matrix_delete(a)
 *     B = fff_matrix_toPyArray(b)
 *     return B             # <<<<<<<<<<<<<<
 * 
 * def matrix_add(A, B):
 */
  Py_INCREF(__pyx_v_B);
  __pyx_r = __pyx_v_B;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.matrix_transpose");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_B);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":311
 *     return B
 * 
 * def matrix_add(A, B):             # <<<<<<<<<<<<<<
 *     """
 *     C = matrix_add(A, B)
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_matrix_add(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_matrix_add[] = "\n    C = matrix_add(A, B)\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_matrix_add(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_b;
  fff_matrix *__pyx_v_c;
  PyObject *__pyx_v_C;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_A,&__pyx_kp_B,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_B);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("matrix_add", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "matrix_add") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_A = values[0];
    __pyx_v_B = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_B = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("matrix_add", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 311; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.matrix_add");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_C = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":316
 *     """
 *     cdef fff_matrix *a, *b, *c
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":317
 *     cdef fff_matrix *a, *b, *c
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)             # <<<<<<<<<<<<<<
 *     c = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(c, a)
 */
  if (!(__Pyx_TypeTest(__pyx_v_B, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_b = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_B));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":318
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)             # <<<<<<<<<<<<<<
 *     fff_matrix_memcpy(c, a)
 *     fff_matrix_add(c, b)
 */
  __pyx_v_c = fff_matrix_new(__pyx_v_a->size1, __pyx_v_a->size2);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":319
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(c, a)             # <<<<<<<<<<<<<<
 *     fff_matrix_add(c, b)
 *     C = fff_matrix_toPyArray(c)
 */
  fff_matrix_memcpy(__pyx_v_c, __pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":320
 *     c = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(c, a)
 *     fff_matrix_add(c, b)             # <<<<<<<<<<<<<<
 *     C = fff_matrix_toPyArray(c)
 *     return C
 */
  fff_matrix_add(__pyx_v_c, __pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":321
 *     fff_matrix_memcpy(c, a)
 *     fff_matrix_add(c, b)
 *     C = fff_matrix_toPyArray(c)             # <<<<<<<<<<<<<<
 *     return C
 * 
 */
  __pyx_1 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_c)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_C);
  __pyx_v_C = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":322
 *     fff_matrix_add(c, b)
 *     C = fff_matrix_toPyArray(c)
 *     return C             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_C);
  __pyx_r = __pyx_v_C;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.matrix_add");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_C);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":326
 * 
 * ## fff_blas.h
 * cdef CBLAS_TRANSPOSE_t flag_transpose( int flag ):             # <<<<<<<<<<<<<<
 *     cdef CBLAS_TRANSPOSE_t x
 *     if flag <= 0:
 */

static  CBLAS_TRANSPOSE_t __pyx_f_4fff2_8bindings_6linalg_flag_transpose(int __pyx_v_flag) {
  CBLAS_TRANSPOSE_t __pyx_v_x;
  CBLAS_TRANSPOSE_t __pyx_r;
  int __pyx_1;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":328
 * cdef CBLAS_TRANSPOSE_t flag_transpose( int flag ):
 *     cdef CBLAS_TRANSPOSE_t x
 *     if flag <= 0:             # <<<<<<<<<<<<<<
 *         x = CblasNoTrans
 *     else:
 */
  __pyx_1 = (__pyx_v_flag <= 0);
  if (__pyx_1) {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":329
 *     cdef CBLAS_TRANSPOSE_t x
 *     if flag <= 0:
 *         x = CblasNoTrans             # <<<<<<<<<<<<<<
 *     else:
 *         x = CblasTrans
 */
    __pyx_v_x = CblasNoTrans;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":331
 *         x = CblasNoTrans
 *     else:
 *         x = CblasTrans             # <<<<<<<<<<<<<<
 *     return x
 * 
 */
    __pyx_v_x = CblasTrans;
  }
  __pyx_L3:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":332
 *     else:
 *         x = CblasTrans
 *     return x             # <<<<<<<<<<<<<<
 * 
 * cdef CBLAS_UPLO_t flag_uplo( int flag ):
 */
  __pyx_r = __pyx_v_x;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":334
 *     return x
 * 
 * cdef CBLAS_UPLO_t flag_uplo( int flag ):             # <<<<<<<<<<<<<<
 *     cdef CBLAS_UPLO_t x
 *     if flag <= 0:
 */

static  CBLAS_UPLO_t __pyx_f_4fff2_8bindings_6linalg_flag_uplo(int __pyx_v_flag) {
  CBLAS_UPLO_t __pyx_v_x;
  CBLAS_UPLO_t __pyx_r;
  int __pyx_1;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":336
 * cdef CBLAS_UPLO_t flag_uplo( int flag ):
 *     cdef CBLAS_UPLO_t x
 *     if flag <= 0:             # <<<<<<<<<<<<<<
 *         x = CblasUpper
 *     else:
 */
  __pyx_1 = (__pyx_v_flag <= 0);
  if (__pyx_1) {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":337
 *     cdef CBLAS_UPLO_t x
 *     if flag <= 0:
 *         x = CblasUpper             # <<<<<<<<<<<<<<
 *     else:
 *         x = CblasLower
 */
    __pyx_v_x = CblasUpper;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":339
 *         x = CblasUpper
 *     else:
 *         x = CblasLower             # <<<<<<<<<<<<<<
 *     return x
 * 
 */
    __pyx_v_x = CblasLower;
  }
  __pyx_L3:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":340
 *     else:
 *         x = CblasLower
 *     return x             # <<<<<<<<<<<<<<
 * 
 * cdef CBLAS_DIAG_t flag_diag( int flag ):
 */
  __pyx_r = __pyx_v_x;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":342
 *     return x
 * 
 * cdef CBLAS_DIAG_t flag_diag( int flag ):             # <<<<<<<<<<<<<<
 *     cdef CBLAS_DIAG_t x
 *     if flag <= 0:
 */

static  CBLAS_DIAG_t __pyx_f_4fff2_8bindings_6linalg_flag_diag(int __pyx_v_flag) {
  CBLAS_DIAG_t __pyx_v_x;
  CBLAS_DIAG_t __pyx_r;
  int __pyx_1;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":344
 * cdef CBLAS_DIAG_t flag_diag( int flag ):
 *     cdef CBLAS_DIAG_t x
 *     if flag <= 0:             # <<<<<<<<<<<<<<
 *         x = CblasNonUnit
 *     else:
 */
  __pyx_1 = (__pyx_v_flag <= 0);
  if (__pyx_1) {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":345
 *     cdef CBLAS_DIAG_t x
 *     if flag <= 0:
 *         x = CblasNonUnit             # <<<<<<<<<<<<<<
 *     else:
 *         x = CblasUnit
 */
    __pyx_v_x = CblasNonUnit;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":347
 *         x = CblasNonUnit
 *     else:
 *         x = CblasUnit             # <<<<<<<<<<<<<<
 *     return x
 * 
 */
    __pyx_v_x = CblasUnit;
  }
  __pyx_L3:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":348
 *     else:
 *         x = CblasUnit
 *     return x             # <<<<<<<<<<<<<<
 * 
 * cdef CBLAS_SIDE_t flag_side( int flag ):
 */
  __pyx_r = __pyx_v_x;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":350
 *     return x
 * 
 * cdef CBLAS_SIDE_t flag_side( int flag ):             # <<<<<<<<<<<<<<
 *     cdef CBLAS_SIDE_t x
 *     if flag <= 0:
 */

static  CBLAS_SIDE_t __pyx_f_4fff2_8bindings_6linalg_flag_side(int __pyx_v_flag) {
  CBLAS_SIDE_t __pyx_v_x;
  CBLAS_SIDE_t __pyx_r;
  int __pyx_1;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":352
 * cdef CBLAS_SIDE_t flag_side( int flag ):
 *     cdef CBLAS_SIDE_t x
 *     if flag <= 0:             # <<<<<<<<<<<<<<
 *         x = CblasLeft
 *     else:
 */
  __pyx_1 = (__pyx_v_flag <= 0);
  if (__pyx_1) {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":353
 *     cdef CBLAS_SIDE_t x
 *     if flag <= 0:
 *         x = CblasLeft             # <<<<<<<<<<<<<<
 *     else:
 *         x = CblasRight
 */
    __pyx_v_x = CblasLeft;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":355
 *         x = CblasLeft
 *     else:
 *         x = CblasRight             # <<<<<<<<<<<<<<
 *     return x
 * 
 */
    __pyx_v_x = CblasRight;
  }
  __pyx_L3:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":356
 *     else:
 *         x = CblasRight
 *     return x             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = __pyx_v_x;
  goto __pyx_L0;

  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":360
 * 
 * ### BLAS 1
 * def blas_dnrm2(X):             # <<<<<<<<<<<<<<
 *     cdef fff_vector *x
 *     x = fff_vector_fromPyArray(X)
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dnrm2(PyObject *__pyx_self, PyObject *__pyx_v_X); /*proto*/
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dnrm2(PyObject *__pyx_self, PyObject *__pyx_v_X) {
  fff_vector *__pyx_v_x;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_self = __pyx_self;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":362
 * def blas_dnrm2(X):
 *     cdef fff_vector *x
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     return fff_blas_dnrm2(x)
 * 
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":363
 *     cdef fff_vector *x
 *     x = fff_vector_fromPyArray(X)
 *     return fff_blas_dnrm2(x)             # <<<<<<<<<<<<<<
 * 
 * def blas_dasum(X):
 */
  __pyx_1 = PyFloat_FromDouble(fff_blas_dnrm2(__pyx_v_x)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dnrm2");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":365
 *     return fff_blas_dnrm2(x)
 * 
 * def blas_dasum(X):             # <<<<<<<<<<<<<<
 *     cdef fff_vector *x
 *     x = fff_vector_fromPyArray(X)
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dasum(PyObject *__pyx_self, PyObject *__pyx_v_X); /*proto*/
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dasum(PyObject *__pyx_self, PyObject *__pyx_v_X) {
  fff_vector *__pyx_v_x;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_self = __pyx_self;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":367
 * def blas_dasum(X):
 *     cdef fff_vector *x
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     return fff_blas_dasum(x)
 * 
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":368
 *     cdef fff_vector *x
 *     x = fff_vector_fromPyArray(X)
 *     return fff_blas_dasum(x)             # <<<<<<<<<<<<<<
 * 
 * def blas_ddot(X, Y):
 */
  __pyx_1 = PyFloat_FromDouble(fff_blas_dasum(__pyx_v_x)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dasum");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":370
 *     return fff_blas_dasum(x)
 * 
 * def blas_ddot(X, Y):             # <<<<<<<<<<<<<<
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_ddot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_ddot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_Y = 0;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_X,&__pyx_kp_Y,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Y);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_ddot", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_ddot") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_X = values[0];
    __pyx_v_Y = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_Y = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_ddot", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_ddot");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":372
 * def blas_ddot(X, Y):
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_fromPyArray(Y)
 *     return fff_blas_ddot(x, y)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":373
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)             # <<<<<<<<<<<<<<
 *     return fff_blas_ddot(x, y)
 * 
 */
  if (!(__Pyx_TypeTest(__pyx_v_Y, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_y = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_Y));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":374
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)
 *     return fff_blas_ddot(x, y)             # <<<<<<<<<<<<<<
 * 
 * def blas_daxpy(double alpha, X, Y):
 */
  __pyx_1 = PyFloat_FromDouble(fff_blas_ddot(__pyx_v_x, __pyx_v_y)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_ddot");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":376
 *     return fff_blas_ddot(x, y)
 * 
 * def blas_daxpy(double alpha, X, Y):             # <<<<<<<<<<<<<<
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_daxpy(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_daxpy(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_alpha;
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_Y = 0;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  fff_vector *__pyx_v_z;
  PyObject *__pyx_v_Z;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_alpha,&__pyx_kp_X,&__pyx_kp_Y,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[3] = {0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_daxpy", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Y);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_daxpy", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_daxpy") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[0]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_X = values[1];
    __pyx_v_Y = values[2];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 1);
    __pyx_v_Y = PyTuple_GET_ITEM(__pyx_args, 2);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_daxpy", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_daxpy");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Z = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":378
 * def blas_daxpy(double alpha, X, Y):
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(y.size)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":379
 *     cdef fff_vector *x, *y, *z
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)             # <<<<<<<<<<<<<<
 *     z = fff_vector_new(y.size)
 *     fff_vector_memcpy(z, y)
 */
  if (!(__Pyx_TypeTest(__pyx_v_Y, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_y = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_Y));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":380
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(y.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(z, y)
 *     fff_blas_daxpy(alpha, x, z)
 */
  __pyx_v_z = fff_vector_new(__pyx_v_y->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":381
 *     y = fff_vector_fromPyArray(Y)
 *     z = fff_vector_new(y.size)
 *     fff_vector_memcpy(z, y)             # <<<<<<<<<<<<<<
 *     fff_blas_daxpy(alpha, x, z)
 *     Z = fff_vector_toPyArray(z)
 */
  fff_vector_memcpy(__pyx_v_z, __pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":382
 *     z = fff_vector_new(y.size)
 *     fff_vector_memcpy(z, y)
 *     fff_blas_daxpy(alpha, x, z)             # <<<<<<<<<<<<<<
 *     Z = fff_vector_toPyArray(z)
 *     return Z
 */
  fff_blas_daxpy(__pyx_v_alpha, __pyx_v_x, __pyx_v_z);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":383
 *     fff_vector_memcpy(z, y)
 *     fff_blas_daxpy(alpha, x, z)
 *     Z = fff_vector_toPyArray(z)             # <<<<<<<<<<<<<<
 *     return Z
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_z)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Z);
  __pyx_v_Z = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":384
 *     fff_blas_daxpy(alpha, x, z)
 *     Z = fff_vector_toPyArray(z)
 *     return Z             # <<<<<<<<<<<<<<
 * 
 * def blas_dscal(double alpha, X):
 */
  Py_INCREF(__pyx_v_Z);
  __pyx_r = __pyx_v_Z;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_daxpy");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Z);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":386
 *     return Z
 * 
 * def blas_dscal(double alpha, X):             # <<<<<<<<<<<<<<
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dscal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dscal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_alpha;
  PyObject *__pyx_v_X = 0;
  fff_vector *__pyx_v_x;
  fff_vector *__pyx_v_y;
  PyObject *__pyx_v_Y;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_alpha,&__pyx_kp_X,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_X);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dscal", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_dscal") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[0]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_X = values[1];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_X = PyTuple_GET_ITEM(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_dscal", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dscal");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_Y = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":388
 * def blas_dscal(double alpha, X):
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)             # <<<<<<<<<<<<<<
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 */
  if (!(__Pyx_TypeTest(__pyx_v_X, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_x = fff_vector_fromPyArray(((PyArrayObject *)__pyx_v_X));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":389
 *     cdef fff_vector *x, *y
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)             # <<<<<<<<<<<<<<
 *     fff_vector_memcpy(y, x)
 *     fff_blas_dscal(alpha, y)
 */
  __pyx_v_y = fff_vector_new(__pyx_v_x->size);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":390
 *     x = fff_vector_fromPyArray(X)
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)             # <<<<<<<<<<<<<<
 *     fff_blas_dscal(alpha, y)
 *     Y = fff_vector_toPyArray(y)
 */
  fff_vector_memcpy(__pyx_v_y, __pyx_v_x);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":391
 *     y = fff_vector_new(x.size)
 *     fff_vector_memcpy(y, x)
 *     fff_blas_dscal(alpha, y)             # <<<<<<<<<<<<<<
 *     Y = fff_vector_toPyArray(y)
 *     return Y
 */
  fff_blas_dscal(__pyx_v_alpha, __pyx_v_y);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":392
 *     fff_vector_memcpy(y, x)
 *     fff_blas_dscal(alpha, y)
 *     Y = fff_vector_toPyArray(y)             # <<<<<<<<<<<<<<
 *     return Y
 * 
 */
  __pyx_1 = ((PyObject *)fff_vector_toPyArray(__pyx_v_y)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_Y);
  __pyx_v_Y = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":393
 *     fff_blas_dscal(alpha, y)
 *     Y = fff_vector_toPyArray(y)
 *     return Y             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_Y);
  __pyx_r = __pyx_v_Y;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dscal");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Y);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":398
 * 
 * ### BLAS 3
 * def blas_dgemm(int TransA, int TransB, double alpha, A, B, double beta, C):             # <<<<<<<<<<<<<<
 *     """
 *     D = blas_dgemm(int TransA, int TransB, double alpha, A, B, double beta, C).
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dgemm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_blas_dgemm[] = "\n    D = blas_dgemm(int TransA, int TransB, double alpha, A, B, double beta, C).\n    \n    Compute the matrix-matrix product and sum D = alpha op(A) op(B) +\n    beta C where op(A) = A, A^T, A^H for TransA = CblasNoTrans,\n    CblasTrans, CblasConjTrans and similarly for the parameter TransB.\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dgemm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_TransA;
  int __pyx_v_TransB;
  double __pyx_v_alpha;
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  double __pyx_v_beta;
  PyObject *__pyx_v_C = 0;
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_b;
  fff_matrix *__pyx_v_c;
  fff_matrix *__pyx_v_d;
  PyObject *__pyx_v_D;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_TransA,&__pyx_kp_TransB,&__pyx_kp_alpha,&__pyx_kp_A,&__pyx_kp_B,&__pyx_kp_beta,&__pyx_kp_C,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[7] = {0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_TransA);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_TransB);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dgemm", 1, 7, 7, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dgemm", 1, 7, 7, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dgemm", 1, 7, 7, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_B);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dgemm", 1, 7, 7, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_beta);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dgemm", 1, 7, 7, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_C);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dgemm", 1, 7, 7, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_dgemm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_TransA = __pyx_PyInt_int(values[0]); if (unlikely((__pyx_v_TransA == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_TransB = __pyx_PyInt_int(values[1]); if (unlikely((__pyx_v_TransB == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[2]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = values[3];
    __pyx_v_B = values[4];
    __pyx_v_beta = __pyx_PyFloat_AsDouble(values[5]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = values[6];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_TransA = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_TransA == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_TransB = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_TransB == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 3);
    __pyx_v_B = PyTuple_GET_ITEM(__pyx_args, 4);
    __pyx_v_beta = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 5)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = PyTuple_GET_ITEM(__pyx_args, 6);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_dgemm", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dgemm");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_D = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":407
 *     """
 *     cdef fff_matrix *a, *b, *c, *d
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":408
 *     cdef fff_matrix *a, *b, *c, *d
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)             # <<<<<<<<<<<<<<
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(c.size1, c.size2)
 */
  if (!(__Pyx_TypeTest(__pyx_v_B, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_b = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_B));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":409
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)             # <<<<<<<<<<<<<<
 *     d = fff_matrix_new(c.size1, c.size2)
 *     fff_matrix_memcpy(d, c)
 */
  if (!(__Pyx_TypeTest(__pyx_v_C, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_c = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_C));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":410
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(c.size1, c.size2)             # <<<<<<<<<<<<<<
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dgemm(flag_transpose(TransA), flag_transpose(TransB), alpha, a, b, beta, d)
 */
  __pyx_v_d = fff_matrix_new(__pyx_v_c->size1, __pyx_v_c->size2);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":411
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(c.size1, c.size2)
 *     fff_matrix_memcpy(d, c)             # <<<<<<<<<<<<<<
 *     fff_blas_dgemm(flag_transpose(TransA), flag_transpose(TransB), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)
 */
  fff_matrix_memcpy(__pyx_v_d, __pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":412
 *     d = fff_matrix_new(c.size1, c.size2)
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dgemm(flag_transpose(TransA), flag_transpose(TransB), alpha, a, b, beta, d)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 */
  fff_blas_dgemm(__pyx_f_4fff2_8bindings_6linalg_flag_transpose(__pyx_v_TransA), __pyx_f_4fff2_8bindings_6linalg_flag_transpose(__pyx_v_TransB), __pyx_v_alpha, __pyx_v_a, __pyx_v_b, __pyx_v_beta, __pyx_v_d);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":413
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dgemm(flag_transpose(TransA), flag_transpose(TransB), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":414
 *     fff_blas_dgemm(flag_transpose(TransA), flag_transpose(TransB), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 */
  fff_matrix_delete(__pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":415
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)             # <<<<<<<<<<<<<<
 *     D = fff_matrix_toPyArray(d)
 *     return D
 */
  fff_matrix_delete(__pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":416
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)             # <<<<<<<<<<<<<<
 *     return D
 * 
 */
  __pyx_1 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_d)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_D);
  __pyx_v_D = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":417
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 *     return D             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_D);
  __pyx_r = __pyx_v_D;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dgemm");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_D);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":420
 * 
 * 
 * def blas_dsymm(int Side, int Uplo, double alpha, A, B, beta, C):             # <<<<<<<<<<<<<<
 *     """
 *     D = blas_dsymm(int Side, int Uplo, double alpha, A, B, beta, C).
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dsymm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_blas_dsymm[] = "\n    D = blas_dsymm(int Side, int Uplo, double alpha, A, B, beta, C).\n    \n    Compute the matrix-matrix product and sum C = lpha A B + eta C\n    for Side is CblasLeft and C = lpha B A + eta C for Side is\n    CblasRight, where the matrix A is symmetric. When Uplo is\n    CblasUpper then the upper triangle and diagonal of A are used, and\n    when Uplo is CblasLower then the lower triangle and diagonal of A\n    are used.\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dsymm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_Side;
  int __pyx_v_Uplo;
  double __pyx_v_alpha;
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  PyObject *__pyx_v_beta = 0;
  PyObject *__pyx_v_C = 0;
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_b;
  fff_matrix *__pyx_v_c;
  fff_matrix *__pyx_v_d;
  PyObject *__pyx_v_D;
  PyObject *__pyx_r;
  double __pyx_1;
  PyObject *__pyx_2 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_Side,&__pyx_kp_Uplo,&__pyx_kp_alpha,&__pyx_kp_A,&__pyx_kp_B,&__pyx_kp_beta,&__pyx_kp_C,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[7] = {0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Side);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Uplo);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsymm", 1, 7, 7, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsymm", 1, 7, 7, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsymm", 1, 7, 7, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_B);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsymm", 1, 7, 7, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_beta);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsymm", 1, 7, 7, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_C);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsymm", 1, 7, 7, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_dsymm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_Side = __pyx_PyInt_int(values[0]); if (unlikely((__pyx_v_Side == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Uplo = __pyx_PyInt_int(values[1]); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[2]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = values[3];
    __pyx_v_B = values[4];
    __pyx_v_beta = values[5];
    __pyx_v_C = values[6];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_Side = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_Side == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Uplo = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 3);
    __pyx_v_B = PyTuple_GET_ITEM(__pyx_args, 4);
    __pyx_v_beta = PyTuple_GET_ITEM(__pyx_args, 5);
    __pyx_v_C = PyTuple_GET_ITEM(__pyx_args, 6);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_dsymm", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dsymm");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_D = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":432
 *     """
 *     cdef fff_matrix *a, *b, *c, *d
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":433
 *     cdef fff_matrix *a, *b, *c, *d
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)             # <<<<<<<<<<<<<<
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(c.size1, c.size2)
 */
  if (!(__Pyx_TypeTest(__pyx_v_B, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_b = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_B));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":434
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)             # <<<<<<<<<<<<<<
 *     d = fff_matrix_new(c.size1, c.size2)
 *     fff_matrix_memcpy(d, c)
 */
  if (!(__Pyx_TypeTest(__pyx_v_C, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_c = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_C));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":435
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(c.size1, c.size2)             # <<<<<<<<<<<<<<
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsymm(flag_side(Side), flag_uplo(Uplo), alpha, a, b, beta, d)
 */
  __pyx_v_d = fff_matrix_new(__pyx_v_c->size1, __pyx_v_c->size2);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":436
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(c.size1, c.size2)
 *     fff_matrix_memcpy(d, c)             # <<<<<<<<<<<<<<
 *     fff_blas_dsymm(flag_side(Side), flag_uplo(Uplo), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)
 */
  fff_matrix_memcpy(__pyx_v_d, __pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":437
 *     d = fff_matrix_new(c.size1, c.size2)
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsymm(flag_side(Side), flag_uplo(Uplo), alpha, a, b, beta, d)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 */
  __pyx_1 = __pyx_PyFloat_AsDouble(__pyx_v_beta); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  fff_blas_dsymm(__pyx_f_4fff2_8bindings_6linalg_flag_side(__pyx_v_Side), __pyx_f_4fff2_8bindings_6linalg_flag_uplo(__pyx_v_Uplo), __pyx_v_alpha, __pyx_v_a, __pyx_v_b, __pyx_1, __pyx_v_d);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":438
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsymm(flag_side(Side), flag_uplo(Uplo), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":439
 *     fff_blas_dsymm(flag_side(Side), flag_uplo(Uplo), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 */
  fff_matrix_delete(__pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":440
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)             # <<<<<<<<<<<<<<
 *     D = fff_matrix_toPyArray(d)
 *     return D
 */
  fff_matrix_delete(__pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":441
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)             # <<<<<<<<<<<<<<
 *     return D
 * 
 */
  __pyx_2 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_d)); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_D);
  __pyx_v_D = __pyx_2;
  __pyx_2 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":442
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 *     return D             # <<<<<<<<<<<<<<
 * 
 * def blas_dtrmm(int Side, int Uplo, int TransA, int Diag, double alpha, A, B):
 */
  Py_INCREF(__pyx_v_D);
  __pyx_r = __pyx_v_D;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dsymm");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_D);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":444
 *     return D
 * 
 * def blas_dtrmm(int Side, int Uplo, int TransA, int Diag, double alpha, A, B):             # <<<<<<<<<<<<<<
 *     """
 *     C = blas_dtrmm(int Side, int Uplo, int TransA, int Diag, double alpha, A, B).
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dtrmm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_blas_dtrmm[] = "\n    C = blas_dtrmm(int Side, int Uplo, int TransA, int Diag, double alpha, A, B).\n    \n    Compute the matrix-matrix product B = lpha op(A) B for Side\n    is CblasLeft and B = lpha B op(A) for Side is CblasRight. The\n    matrix A is triangular and op(A) = A, A^T, A^H for TransA =\n    CblasNoTrans, CblasTrans, CblasConjTrans. When Uplo is CblasUpper\n    then the upper triangle of A is used, and when Uplo is CblasLower\n    then the lower triangle of A is used. If Diag is CblasNonUnit then\n    the diagonal of A is used, but if Diag is CblasUnit then the\n    diagonal elements of the matrix A are taken as unity and are not\n    referenced.\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dtrmm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_Side;
  int __pyx_v_Uplo;
  int __pyx_v_TransA;
  int __pyx_v_Diag;
  double __pyx_v_alpha;
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_b;
  fff_matrix *__pyx_v_c;
  PyObject *__pyx_v_C;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_Side,&__pyx_kp_Uplo,&__pyx_kp_TransA,&__pyx_kp_Diag,&__pyx_kp_alpha,&__pyx_kp_A,&__pyx_kp_B,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[7] = {0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Side);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Uplo);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrmm", 1, 7, 7, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_TransA);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrmm", 1, 7, 7, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Diag);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrmm", 1, 7, 7, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrmm", 1, 7, 7, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrmm", 1, 7, 7, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_B);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrmm", 1, 7, 7, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_dtrmm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_Side = __pyx_PyInt_int(values[0]); if (unlikely((__pyx_v_Side == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Uplo = __pyx_PyInt_int(values[1]); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_TransA = __pyx_PyInt_int(values[2]); if (unlikely((__pyx_v_TransA == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Diag = __pyx_PyInt_int(values[3]); if (unlikely((__pyx_v_Diag == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[4]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = values[5];
    __pyx_v_B = values[6];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_Side = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_Side == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Uplo = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_TransA = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_TransA == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Diag = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_Diag == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 5);
    __pyx_v_B = PyTuple_GET_ITEM(__pyx_args, 6);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_dtrmm", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dtrmm");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_C = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":459
 *     """
 *     cdef fff_matrix *a, *b, *c
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":460
 *     cdef fff_matrix *a, *b, *c
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)             # <<<<<<<<<<<<<<
 *     c = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(c, b)
 */
  if (!(__Pyx_TypeTest(__pyx_v_B, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_b = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_B));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":461
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)             # <<<<<<<<<<<<<<
 *     fff_matrix_memcpy(c, b)
 *     fff_blas_dtrmm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 */
  __pyx_v_c = fff_matrix_new(__pyx_v_a->size1, __pyx_v_a->size2);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":462
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(c, b)             # <<<<<<<<<<<<<<
 *     fff_blas_dtrmm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 *                    alpha, a, c)
 */
  fff_matrix_memcpy(__pyx_v_c, __pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":464
 *     fff_matrix_memcpy(c, b)
 *     fff_blas_dtrmm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 *                    alpha, a, c)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 */
  fff_blas_dtrmm(__pyx_f_4fff2_8bindings_6linalg_flag_side(__pyx_v_Side), __pyx_f_4fff2_8bindings_6linalg_flag_uplo(__pyx_v_Uplo), __pyx_f_4fff2_8bindings_6linalg_flag_transpose(__pyx_v_TransA), __pyx_f_4fff2_8bindings_6linalg_flag_diag(__pyx_v_Diag), __pyx_v_alpha, __pyx_v_a, __pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":465
 *     fff_blas_dtrmm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 *                    alpha, a, c)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(b)
 *     C = fff_matrix_toPyArray(c)
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":466
 *                    alpha, a, c)
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)             # <<<<<<<<<<<<<<
 *     C = fff_matrix_toPyArray(c)
 *     return C
 */
  fff_matrix_delete(__pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":467
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 *     C = fff_matrix_toPyArray(c)             # <<<<<<<<<<<<<<
 *     return C
 * 
 */
  __pyx_1 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_c)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_C);
  __pyx_v_C = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":468
 *     fff_matrix_delete(b)
 *     C = fff_matrix_toPyArray(c)
 *     return C             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_C);
  __pyx_r = __pyx_v_C;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dtrmm");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_C);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":471
 * 
 * 
 * def blas_dtrsm(int Side, int Uplo, int TransA, int Diag, double alpha, A, B):             # <<<<<<<<<<<<<<
 *     """
 *     blas_dtrsm(int Side, int Uplo, int TransA, int Diag, double alpha, A, B).
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dtrsm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_blas_dtrsm[] = "\n    blas_dtrsm(int Side, int Uplo, int TransA, int Diag, double alpha, A, B).\n    \n    Compute the inverse-matrix matrix product B = lpha\n    op(inv(A))B for Side is CblasLeft and B = lpha B op(inv(A)) for\n    Side is CblasRight. The matrix A is triangular and op(A) = A, A^T,\n    A^H for TransA = CblasNoTrans, CblasTrans, CblasConjTrans. When\n    Uplo is CblasUpper then the upper triangle of A is used, and when\n    Uplo is CblasLower then the lower triangle of A is used. If Diag\n    is CblasNonUnit then the diagonal of A is used, but if Diag is\n    CblasUnit then the diagonal elements of the matrix A are taken as\n    unity and are not referenced.\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dtrsm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_Side;
  int __pyx_v_Uplo;
  int __pyx_v_TransA;
  int __pyx_v_Diag;
  double __pyx_v_alpha;
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_b;
  fff_matrix *__pyx_v_c;
  PyObject *__pyx_v_C;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_Side,&__pyx_kp_Uplo,&__pyx_kp_TransA,&__pyx_kp_Diag,&__pyx_kp_alpha,&__pyx_kp_A,&__pyx_kp_B,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[7] = {0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Side);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Uplo);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrsm", 1, 7, 7, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_TransA);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrsm", 1, 7, 7, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Diag);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrsm", 1, 7, 7, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrsm", 1, 7, 7, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrsm", 1, 7, 7, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_B);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dtrsm", 1, 7, 7, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_dtrsm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_Side = __pyx_PyInt_int(values[0]); if (unlikely((__pyx_v_Side == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Uplo = __pyx_PyInt_int(values[1]); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_TransA = __pyx_PyInt_int(values[2]); if (unlikely((__pyx_v_TransA == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Diag = __pyx_PyInt_int(values[3]); if (unlikely((__pyx_v_Diag == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[4]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = values[5];
    __pyx_v_B = values[6];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_Side = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_Side == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Uplo = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_TransA = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_TransA == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Diag = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_Diag == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 5);
    __pyx_v_B = PyTuple_GET_ITEM(__pyx_args, 6);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_dtrsm", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dtrsm");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_C = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":486
 *     """
 *     cdef fff_matrix *a, *b, *c
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":487
 *     cdef fff_matrix *a, *b, *c
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)             # <<<<<<<<<<<<<<
 *     c = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(c, b)
 */
  if (!(__Pyx_TypeTest(__pyx_v_B, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_b = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_B));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":488
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)             # <<<<<<<<<<<<<<
 *     fff_matrix_memcpy(c, b)
 *     fff_blas_dtrsm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 */
  __pyx_v_c = fff_matrix_new(__pyx_v_a->size1, __pyx_v_a->size2);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":489
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(c, b)             # <<<<<<<<<<<<<<
 *     fff_blas_dtrsm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 *                    alpha, a, c)
 */
  fff_matrix_memcpy(__pyx_v_c, __pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":491
 *     fff_matrix_memcpy(c, b)
 *     fff_blas_dtrsm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 *                    alpha, a, c)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 */
  fff_blas_dtrsm(__pyx_f_4fff2_8bindings_6linalg_flag_side(__pyx_v_Side), __pyx_f_4fff2_8bindings_6linalg_flag_uplo(__pyx_v_Uplo), __pyx_f_4fff2_8bindings_6linalg_flag_transpose(__pyx_v_TransA), __pyx_f_4fff2_8bindings_6linalg_flag_diag(__pyx_v_Diag), __pyx_v_alpha, __pyx_v_a, __pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":492
 *     fff_blas_dtrsm(flag_side(Side), flag_uplo(Uplo), flag_transpose(TransA), flag_diag(Diag),
 *                    alpha, a, c)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(b)
 *     C = fff_matrix_toPyArray(c)
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":493
 *                    alpha, a, c)
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)             # <<<<<<<<<<<<<<
 *     C = fff_matrix_toPyArray(c)
 *     return C
 */
  fff_matrix_delete(__pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":494
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 *     C = fff_matrix_toPyArray(c)             # <<<<<<<<<<<<<<
 *     return C
 * 
 */
  __pyx_1 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_c)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_C);
  __pyx_v_C = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":495
 *     fff_matrix_delete(b)
 *     C = fff_matrix_toPyArray(c)
 *     return C             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_C);
  __pyx_r = __pyx_v_C;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dtrsm");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_C);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":498
 * 
 * 
 * def blas_dsyrk(int Uplo, int Trans, double alpha, A, double beta, C):             # <<<<<<<<<<<<<<
 *     """
 *     D = blas_dsyrk(int Uplo, int Trans, double alpha, A, double beta, C).
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dsyrk(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_blas_dsyrk[] = "\n    D = blas_dsyrk(int Uplo, int Trans, double alpha, A, double beta, C).\n    \n    Compute a rank-k update of the symmetric matrix C, C = lpha A\n    A^T + eta C when Trans is CblasNoTrans and C = lpha A^T A +\n    eta C when Trans is CblasTrans. Since the matrix C is symmetric\n    only its upper half or lower half need to be stored. When Uplo is\n    CblasUpper then the upper triangle and diagonal of C are used, and\n    when Uplo is CblasLower then the lower triangle and diagonal of C\n    are used.\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dsyrk(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_Uplo;
  int __pyx_v_Trans;
  double __pyx_v_alpha;
  PyObject *__pyx_v_A = 0;
  double __pyx_v_beta;
  PyObject *__pyx_v_C = 0;
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_c;
  fff_matrix *__pyx_v_d;
  PyObject *__pyx_v_D;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_Uplo,&__pyx_kp_Trans,&__pyx_kp_alpha,&__pyx_kp_A,&__pyx_kp_beta,&__pyx_kp_C,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[6] = {0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Uplo);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Trans);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyrk", 1, 6, 6, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyrk", 1, 6, 6, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyrk", 1, 6, 6, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_beta);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyrk", 1, 6, 6, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_C);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyrk", 1, 6, 6, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_dsyrk") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_Uplo = __pyx_PyInt_int(values[0]); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Trans = __pyx_PyInt_int(values[1]); if (unlikely((__pyx_v_Trans == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[2]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = values[3];
    __pyx_v_beta = __pyx_PyFloat_AsDouble(values[4]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = values[5];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_Uplo = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Trans = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_Trans == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 3);
    __pyx_v_beta = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = PyTuple_GET_ITEM(__pyx_args, 5);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_dsyrk", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dsyrk");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_D = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":511
 *     """
 *     cdef fff_matrix *a, *c, *d
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(a.size1, a.size2)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":512
 *     cdef fff_matrix *a, *c, *d
 *     a = fff_matrix_fromPyArray(A)
 *     c = fff_matrix_fromPyArray(C)             # <<<<<<<<<<<<<<
 *     d = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(d, c)
 */
  if (!(__Pyx_TypeTest(__pyx_v_C, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_c = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_C));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":513
 *     a = fff_matrix_fromPyArray(A)
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(a.size1, a.size2)             # <<<<<<<<<<<<<<
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsyrk(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, beta, d)
 */
  __pyx_v_d = fff_matrix_new(__pyx_v_a->size1, __pyx_v_a->size2);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":514
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(d, c)             # <<<<<<<<<<<<<<
 *     fff_blas_dsyrk(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, beta, d)
 *     fff_matrix_delete(a)
 */
  fff_matrix_memcpy(__pyx_v_d, __pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":515
 *     d = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsyrk(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, beta, d)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(c)
 */
  fff_blas_dsyrk(__pyx_f_4fff2_8bindings_6linalg_flag_uplo(__pyx_v_Uplo), __pyx_f_4fff2_8bindings_6linalg_flag_transpose(__pyx_v_Trans), __pyx_v_alpha, __pyx_v_a, __pyx_v_beta, __pyx_v_d);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":516
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsyrk(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, beta, d)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":517
 *     fff_blas_dsyrk(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, beta, d)
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(c)             # <<<<<<<<<<<<<<
 *     D = fff_matrix_toPyArray(d)
 *     return D
 */
  fff_matrix_delete(__pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":518
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)             # <<<<<<<<<<<<<<
 *     return D
 * 
 */
  __pyx_1 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_d)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_D);
  __pyx_v_D = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":519
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 *     return D             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_D);
  __pyx_r = __pyx_v_D;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dsyrk");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_D);
  return __pyx_r;
}

/* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":522
 * 
 * 
 * def blas_dsyr2k(int Uplo, int Trans, double alpha, A, B, double beta, C):             # <<<<<<<<<<<<<<
 *     """
 *     Compute a rank-2k update of the symmetric matrix C, C = \alpha A B^T +
 */

static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dsyr2k(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4fff2_8bindings_6linalg_blas_dsyr2k[] = "\n    Compute a rank-2k update of the symmetric matrix C, C = lpha A B^T +\n    lpha B A^T + eta C when Trans is CblasNoTrans and C = lpha A^T B\n    + lpha B^T A + eta C when Trans is CblasTrans. Since the matrix C\n    is symmetric only its upper half or lower half need to be stored. When\n    Uplo is CblasUpper then the upper triangle and diagonal of C are used,\n    and when Uplo is CblasLower then the lower triangle and diagonal of C\n    are used.\n    ";
static PyObject *__pyx_pf_4fff2_8bindings_6linalg_blas_dsyr2k(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_Uplo;
  int __pyx_v_Trans;
  double __pyx_v_alpha;
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  double __pyx_v_beta;
  PyObject *__pyx_v_C = 0;
  fff_matrix *__pyx_v_a;
  fff_matrix *__pyx_v_b;
  fff_matrix *__pyx_v_c;
  fff_matrix *__pyx_v_d;
  PyObject *__pyx_v_D;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_Uplo,&__pyx_kp_Trans,&__pyx_kp_alpha,&__pyx_kp_A,&__pyx_kp_B,&__pyx_kp_beta,&__pyx_kp_C,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[7] = {0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Uplo);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_Trans);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyr2k", 1, 7, 7, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_alpha);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyr2k", 1, 7, 7, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_A);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyr2k", 1, 7, 7, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_B);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyr2k", 1, 7, 7, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_beta);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyr2k", 1, 7, 7, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_C);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("blas_dsyr2k", 1, 7, 7, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "blas_dsyr2k") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_Uplo = __pyx_PyInt_int(values[0]); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Trans = __pyx_PyInt_int(values[1]); if (unlikely((__pyx_v_Trans == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(values[2]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = values[3];
    __pyx_v_B = values[4];
    __pyx_v_beta = __pyx_PyFloat_AsDouble(values[5]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = values[6];
  } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_Uplo = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely((__pyx_v_Uplo == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_Trans = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_Trans == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_alpha = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_A = PyTuple_GET_ITEM(__pyx_args, 3);
    __pyx_v_B = PyTuple_GET_ITEM(__pyx_args, 4);
    __pyx_v_beta = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 5)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = PyTuple_GET_ITEM(__pyx_args, 6);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("blas_dsyr2k", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dsyr2k");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_D = Py_None; Py_INCREF(Py_None);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":533
 *     """
 *     cdef fff_matrix *a, *b, *c, *d
 *     a = fff_matrix_fromPyArray(A)             # <<<<<<<<<<<<<<
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)
 */
  if (!(__Pyx_TypeTest(__pyx_v_A, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_a = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_A));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":534
 *     cdef fff_matrix *a, *b, *c, *d
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)             # <<<<<<<<<<<<<<
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(a.size1, a.size2)
 */
  if (!(__Pyx_TypeTest(__pyx_v_B, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_b = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_B));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":535
 *     a = fff_matrix_fromPyArray(A)
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)             # <<<<<<<<<<<<<<
 *     d = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(d, c)
 */
  if (!(__Pyx_TypeTest(__pyx_v_C, __pyx_ptype_4fff2_8bindings_6linalg_ndarray))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_c = fff_matrix_fromPyArray(((PyArrayObject *)__pyx_v_C));

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":536
 *     b = fff_matrix_fromPyArray(B)
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(a.size1, a.size2)             # <<<<<<<<<<<<<<
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsyr2k(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, b, beta, d)
 */
  __pyx_v_d = fff_matrix_new(__pyx_v_a->size1, __pyx_v_a->size2);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":537
 *     c = fff_matrix_fromPyArray(C)
 *     d = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(d, c)             # <<<<<<<<<<<<<<
 *     fff_blas_dsyr2k(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)
 */
  fff_matrix_memcpy(__pyx_v_d, __pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":538
 *     d = fff_matrix_new(a.size1, a.size2)
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsyr2k(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, b, beta, d)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 */
  fff_blas_dsyr2k(__pyx_f_4fff2_8bindings_6linalg_flag_uplo(__pyx_v_Uplo), __pyx_f_4fff2_8bindings_6linalg_flag_transpose(__pyx_v_Trans), __pyx_v_alpha, __pyx_v_a, __pyx_v_b, __pyx_v_beta, __pyx_v_d);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":539
 *     fff_matrix_memcpy(d, c)
 *     fff_blas_dsyr2k(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)
 */
  fff_matrix_delete(__pyx_v_a);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":540
 *     fff_blas_dsyr2k(flag_uplo(Uplo), flag_transpose(Trans), alpha, a, b, beta, d)
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)             # <<<<<<<<<<<<<<
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 */
  fff_matrix_delete(__pyx_v_b);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":541
 *     fff_matrix_delete(a)
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)             # <<<<<<<<<<<<<<
 *     D = fff_matrix_toPyArray(d)
 *     return D
 */
  fff_matrix_delete(__pyx_v_c);

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":542
 *     fff_matrix_delete(b)
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)             # <<<<<<<<<<<<<<
 *     return D
 * 
 */
  __pyx_1 = ((PyObject *)fff_matrix_toPyArray(__pyx_v_d)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_D);
  __pyx_v_D = __pyx_1;
  __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":543
 *     fff_matrix_delete(c)
 *     D = fff_matrix_toPyArray(d)
 *     return D             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_D);
  __pyx_r = __pyx_v_D;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg.blas_dsyr2k");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_D);
  return __pyx_r;
}

static struct PyMethodDef __pyx_methods[] = {
  {"vector_get", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_get, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_get},
  {"vector_set", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_set, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_set},
  {"vector_set_all", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_set_all, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_set_all},
  {"vector_scale", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_scale, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_scale},
  {"vector_add_constant", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_add_constant, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_add_constant},
  {"vector_add", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_add, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_add},
  {"vector_sub", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_sub, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_sub},
  {"vector_mul", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_mul, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_mul},
  {"vector_div", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_div, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_div},
  {"vector_sum", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_sum, METH_O, __pyx_doc_4fff2_8bindings_6linalg_vector_sum},
  {"vector_ssd", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_ssd, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_ssd},
  {"vector_sad", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_sad, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_sad},
  {"vector_median", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_median, METH_O, __pyx_doc_4fff2_8bindings_6linalg_vector_median},
  {"vector_quantile", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_vector_quantile, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_vector_quantile},
  {"matrix_get", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_matrix_get, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_matrix_get},
  {"matrix_transpose", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_matrix_transpose, METH_O, __pyx_doc_4fff2_8bindings_6linalg_matrix_transpose},
  {"matrix_add", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_matrix_add, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_matrix_add},
  {"blas_dnrm2", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dnrm2, METH_O, 0},
  {"blas_dasum", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dasum, METH_O, 0},
  {"blas_ddot", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_ddot, METH_VARARGS|METH_KEYWORDS, 0},
  {"blas_daxpy", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_daxpy, METH_VARARGS|METH_KEYWORDS, 0},
  {"blas_dscal", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dscal, METH_VARARGS|METH_KEYWORDS, 0},
  {"blas_dgemm", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dgemm, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_blas_dgemm},
  {"blas_dsymm", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dsymm, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_blas_dsymm},
  {"blas_dtrmm", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dtrmm, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_blas_dtrmm},
  {"blas_dtrsm", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dtrsm, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_blas_dtrsm},
  {"blas_dsyrk", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dsyrk, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_blas_dsyrk},
  {"blas_dsyr2k", (PyCFunction)__pyx_pf_4fff2_8bindings_6linalg_blas_dsyr2k, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4fff2_8bindings_6linalg_blas_dsyr2k},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
    PyModuleDef_HEAD_INIT,
    "linalg",
    __pyx_mdoc, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp_X, __pyx_k_X, sizeof(__pyx_k_X), 1, 1, 1},
  {&__pyx_kp_i, __pyx_k_i, sizeof(__pyx_k_i), 1, 1, 1},
  {&__pyx_kp_a, __pyx_k_a, sizeof(__pyx_k_a), 1, 1, 1},
  {&__pyx_kp_Y, __pyx_k_Y, sizeof(__pyx_k_Y), 1, 1, 1},
  {&__pyx_kp_m, __pyx_k_m, sizeof(__pyx_k_m), 1, 1, 1},
  {&__pyx_kp_fixed, __pyx_k_fixed, sizeof(__pyx_k_fixed), 1, 1, 1},
  {&__pyx_kp_r, __pyx_k_r, sizeof(__pyx_k_r), 1, 1, 1},
  {&__pyx_kp_interp, __pyx_k_interp, sizeof(__pyx_k_interp), 1, 1, 1},
  {&__pyx_kp_A, __pyx_k_A, sizeof(__pyx_k_A), 1, 1, 1},
  {&__pyx_kp_j, __pyx_k_j, sizeof(__pyx_k_j), 1, 1, 1},
  {&__pyx_kp_B, __pyx_k_B, sizeof(__pyx_k_B), 1, 1, 1},
  {&__pyx_kp_alpha, __pyx_k_alpha, sizeof(__pyx_k_alpha), 1, 1, 1},
  {&__pyx_kp_TransA, __pyx_k_TransA, sizeof(__pyx_k_TransA), 1, 1, 1},
  {&__pyx_kp_TransB, __pyx_k_TransB, sizeof(__pyx_k_TransB), 1, 1, 1},
  {&__pyx_kp_beta, __pyx_k_beta, sizeof(__pyx_k_beta), 1, 1, 1},
  {&__pyx_kp_C, __pyx_k_C, sizeof(__pyx_k_C), 1, 1, 1},
  {&__pyx_kp_Side, __pyx_k_Side, sizeof(__pyx_k_Side), 1, 1, 1},
  {&__pyx_kp_Uplo, __pyx_k_Uplo, sizeof(__pyx_k_Uplo), 1, 1, 1},
  {&__pyx_kp_Diag, __pyx_k_Diag, sizeof(__pyx_k_Diag), 1, 1, 1},
  {&__pyx_kp_Trans, __pyx_k_Trans, sizeof(__pyx_k_Trans), 1, 1, 1},
  {&__pyx_kp___version__, __pyx_k___version__, sizeof(__pyx_k___version__), 1, 1, 1},
  {&__pyx_kp_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 1, 1, 1},
  {&__pyx_kp_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 1, 1},
  {&__pyx_kp_1, __pyx_k_1, sizeof(__pyx_k_1), 0, 0, 0},
  {0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  return 0;
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initlinalg(void); /*proto*/
PyMODINIT_FUNC initlinalg(void)
#else
PyMODINIT_FUNC PyInit_linalg(void); /*proto*/
PyMODINIT_FUNC PyInit_linalg(void)
#endif
{
  PyObject *__pyx_1 = 0;
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Library function declarations ---*/
  __pyx_init_filenames();
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("linalg", __pyx_methods, __pyx_mdoc, 0, PYTHON_API_VERSION);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  #if PY_MAJOR_VERSION < 3
  Py_INCREF(__pyx_m);
  #endif
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME);
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_skip_dispatch = 0;
  /*--- Global init code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  __pyx_ptype_4fff2_8bindings_6linalg_dtype = __Pyx_ImportType("numpy", "dtype", sizeof(PyArray_Descr)); if (unlikely(!__pyx_ptype_4fff2_8bindings_6linalg_dtype)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_4fff2_8bindings_6linalg_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject)); if (unlikely(!__pyx_ptype_4fff2_8bindings_6linalg_ndarray)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_4fff2_8bindings_6linalg_flatiter = __Pyx_ImportType("numpy", "flatiter", sizeof(PyArrayIterObject)); if (unlikely(!__pyx_ptype_4fff2_8bindings_6linalg_flatiter)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_4fff2_8bindings_6linalg_broadcast = __Pyx_ImportType("numpy", "broadcast", sizeof(PyArrayMultiIterObject)); if (unlikely(!__pyx_ptype_4fff2_8bindings_6linalg_broadcast)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Type import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":10
 * """
 * 
 * __version__ = '0.1'             # <<<<<<<<<<<<<<
 * 
 * # Include fff
 */
  if (PyObject_SetAttr(__pyx_m, __pyx_kp___version__, __pyx_kp_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":84
 * 
 * # Initialize numpy
 * fffpy_import_array()             # <<<<<<<<<<<<<<
 * import_array()
 * import numpy as np
 */
  fffpy_import_array();

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":85
 * # Initialize numpy
 * fffpy_import_array()
 * import_array()             # <<<<<<<<<<<<<<
 * import numpy as np
 * 
 */
  import_array();

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":86
 * fffpy_import_array()
 * import_array()
 * import numpy as np             # <<<<<<<<<<<<<<
 * 
 * # Binded routines
 */
  __pyx_1 = __Pyx_Import(__pyx_kp_numpy, 0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_np, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 86; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "d:\home\ar203069\bzr\nipy\fff2\fff2\bindings\linalg.pyx":522
 * 
 * 
 * def blas_dsyr2k(int Uplo, int Trans, double alpha, A, B, double beta, C):             # <<<<<<<<<<<<<<
 *     """
 *     Compute a rank-2k update of the symmetric matrix C, C = \alpha A B^T +
 */
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("fff2.bindings.linalg");
  #if PY_MAJOR_VERSION >= 3
  return NULL;
  #endif
}

static const char *__pyx_filenames[] = {
  "linalg.pyx",
  "numpy.pxi",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AS_STRING(kw_name));
        #endif
}

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *number, *more_or_less;

    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    number = (num_expected == 1) ? "" : "s";
    PyErr_Format(PyExc_TypeError,
        #if PY_VERSION_HEX < 0x02050000
            "%s() takes %s %d positional argument%s (%d given)",
        #else
            "%s() takes %s %zd positional argument%s (%zd given)",
        #endif
        func_name, more_or_less, num_expected, number, num_found);
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;

    while (PyDict_Next(kwds, &pos, &key, &value)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key))) {
        #else
        if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key))) {
        #endif
            goto invalid_keyword_type;
        } else {
            name = argnames;
            while (*name && (**name != key)) name++;
            if (*name) {
                if (name < first_kw_arg) goto arg_passed_twice;
                values[name-argnames] = value;
            } else {
                for (name = first_kw_arg; *name; name++) {
                    #if PY_MAJOR_VERSION >= 3
                    if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                        PyUnicode_Compare(**name, key) == 0) break;
                    #else
                    if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                        strcmp(PyString_AS_STRING(**name),
                               PyString_AS_STRING(key)) == 0) break;
                    #endif
                }
                if (*name) {
                    values[name-argnames] = value;
                } else {
                    /* unexpected keyword found */
                    for (name=argnames; name != first_kw_arg; name++) {
                        if (**name == key) goto arg_passed_twice;
                        #if PY_MAJOR_VERSION >= 3
                        if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                            PyUnicode_Compare(**name, key) == 0) goto arg_passed_twice;
                        #else
                        if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                            strcmp(PyString_AS_STRING(**name),
                                   PyString_AS_STRING(key)) == 0) goto arg_passed_twice;
                        #endif
                    }
                    if (kwds2) {
                        if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
                    } else {
                        goto invalid_keyword;
                    }
                }
            }
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, **name);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    long size)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;

    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(class_name);
    #else
    py_name = PyUnicode_FromString(class_name);
    #endif
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;

    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(name);
    #else
    py_name = PyUnicode_FromString(name);
    #endif
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(const char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;

    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(__pyx_filename);
    #else
    py_srcfile = PyUnicode_FromString(__pyx_filename);
    #endif
    if (!py_srcfile) goto bad;
    if (__pyx_clineno) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    #if PY_MAJOR_VERSION < 3
    empty_string = PyString_FromStringAndSize("", 0);
    #else
    empty_string = PyBytes_FromStringAndSize("", 0);
    #endif
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        #if PY_MAJOR_VERSION >= 3
        0,            /*int kwonlyargcount,*/
        #endif
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        __pyx_empty_tuple,  /*PyObject *consts,*/
        __pyx_empty_tuple,  /*PyObject *names,*/
        __pyx_empty_tuple,  /*PyObject *varnames,*/
        __pyx_empty_tuple,  /*PyObject *freevars,*/
        __pyx_empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode && (!t->is_identifier)) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else  /* Python 3+ has unicode identifiers */
        if (t->is_identifier || (t->is_unicode && t->intern)) {
            *t->p = PyUnicode_InternFromString(t->s);
        } else if (t->is_unicode) {
            *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

/* Type Conversion Functions */

static INLINE Py_ssize_t __pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject* x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}

static INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   if (x == Py_True) return 1;
   else if (x == Py_False) return 0;
   else return PyObject_IsTrue(x);
}

static INLINE PY_LONG_LONG __pyx_PyInt_AsLongLong(PyObject* x) {
    if (PyInt_CheckExact(x)) {
        return PyInt_AS_LONG(x);
    }
    else if (PyLong_CheckExact(x)) {
        return PyLong_AsLongLong(x);
    }
    else {
        PY_LONG_LONG val;
        PyObject* tmp = PyNumber_Int(x); if (!tmp) return (PY_LONG_LONG)-1;
        val = __pyx_PyInt_AsLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE unsigned PY_LONG_LONG __pyx_PyInt_AsUnsignedLongLong(PyObject* x) {
    if (PyInt_CheckExact(x)) {
        long val = PyInt_AS_LONG(x);
        if (unlikely(val < 0)) {
            PyErr_SetString(PyExc_TypeError, "Negative assignment to unsigned type.");
            return (unsigned PY_LONG_LONG)-1;
        }
        return val;
    }
    else if (PyLong_CheckExact(x)) {
        return PyLong_AsUnsignedLongLong(x);
    }
    else {
        PY_LONG_LONG val;
        PyObject* tmp = PyNumber_Int(x); if (!tmp) return (PY_LONG_LONG)-1;
        val = __pyx_PyInt_AsUnsignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}


static INLINE unsigned char __pyx_PyInt_unsigned_char(PyObject* x) {
    if (sizeof(unsigned char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        unsigned char val = (unsigned char)long_val;
        if (unlikely((val != long_val)  || (long_val < 0))) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to unsigned char");
            return (unsigned char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE unsigned short __pyx_PyInt_unsigned_short(PyObject* x) {
    if (sizeof(unsigned short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        unsigned short val = (unsigned short)long_val;
        if (unlikely((val != long_val)  || (long_val < 0))) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to unsigned short");
            return (unsigned short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE char __pyx_PyInt_char(PyObject* x) {
    if (sizeof(char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        char val = (char)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to char");
            return (char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE short __pyx_PyInt_short(PyObject* x) {
    if (sizeof(short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        short val = (short)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to short");
            return (short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE int __pyx_PyInt_int(PyObject* x) {
    if (sizeof(int) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        int val = (int)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to int");
            return (int)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE long __pyx_PyInt_long(PyObject* x) {
    if (sizeof(long) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        long val = (long)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to long");
            return (long)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed char __pyx_PyInt_signed_char(PyObject* x) {
    if (sizeof(signed char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed char val = (signed char)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed char");
            return (signed char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed short __pyx_PyInt_signed_short(PyObject* x) {
    if (sizeof(signed short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed short val = (signed short)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed short");
            return (signed short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed int __pyx_PyInt_signed_int(PyObject* x) {
    if (sizeof(signed int) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed int val = (signed int)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed int");
            return (signed int)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed long __pyx_PyInt_signed_long(PyObject* x) {
    if (sizeof(signed long) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed long val = (signed long)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed long");
            return (signed long)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE long double __pyx_PyInt_long_double(PyObject* x) {
    if (sizeof(long double) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        long double val = (long double)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to long double");
            return (long double)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

