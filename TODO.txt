=========================
TODO for NIPY development
=========================


Create NIPY sidebar with links to all project related websites.


Tests
-----

Some issues specific to tests to cleanup.

- Remove creation of named temporary files "\*.nii", use NamedTemporaryFile 
  instead in test modules:

  * modalities/fmri/tests/test_regression.py 
  * modalities/fmri/fmristat/tests/test_model.py

- Affine is wrong in test_image.  Formats.Analyze reported 4x4 with
  MNI translation in 4th column.  PyniftiIO reports 5x5 with only one
  pixdim translation.

- Pass all tests.

Trac Wiki
---------

- Update the README and INSTALL on the Trac Wiki.  These should
  reference a reST formatted version committed to the repository.
  Include information on downloading the fmri data and running the
  tests.

Nipy code base
--------------

Update INSTALL and README so they are current.  Add list of
dependencies in the INSTALL.

Delete neuroimaging/utils/path.py.  This custom path module does not
provide any benefit over os.path.  Using a non-standard path module
adds confusion to the code.  This will require going through the code
base and updating all references to the path module.  Perhaps a good
use of grin for a global search and replace.

Convert from nipy datasource to numpy datasource.  Then remove
  nipy's datasource.py

Rewrite weave code in algorithms/statistics/intrinsic_volumes.py as C extension.

Use sphinx to generate docs and update neuroimaging.scipy.org/api.

Determine need for odict.py.  Verify origin and license if we
determine we need it.

Cleanup neuroimaging.testing directory.  Possibly rename 'testing' to
'tests'.  Move utils.tests.data.__init__.py to tests and update import
statements in all test modules.

Remove neuroimaging.utils dir. (path.py and odict.py should be in externals)


Code Design Thoughts
--------------------

Perhaps there's a better place for this, but I wanted a central
location to dump thoughts that could be shared by the developers and
tracked easily.  I also don't like having to switch from my code
editor to a browser just to jot down an idea like this.

Image Class
-----------

- save function should accept filename or file-like object.  If I have
  an open file I would like to be able to pass that in also, instead
  of fp.name.  Happens in test code a lot.

- Add dtype options when saving. When saving images it uses the native
  dtype for the system.  Should be able to specify this.  in the
  test_file_roundtrip, self.img is a uint8, but is saved to tmpfile as
  float64.  Adding this would allow us to save images without the
  scaling being applied.

- In image._open(url, ...), should we test if the "url" is a PyNiftiIO
  object already? This was in the tests from 'old code' and passed::
  
    new = Image(self.img._data, self.img.grid) 

  img._data is a PyNIftiIO object.  It works, but we should verify
  it's harmless otherwise prevent it from happening.

- Rename SamplingGrid to CoordinateMap.  Image.grid to Image.coordmap?

Functions should only require filename/url, not a (filename, repository) pair.

Image Iterators
---------------

- Cleanup the image iterators/generators.  I believe Jonathan was in
  the process of converting the code from using iterators to
  generators after the Paris Sprint.  This code transition is not
  complete.

Future Features
---------------

Egg support.  Look to revno 1642, a setup_egg.py that Gael had added.
This was removed as it did not work.  It did appear to allow this
development install option, which we should restore when eggs are working::

    sudo python setup_egg.py develop --prefix /usr/local

Add Fernando's nose fix for running doctests in extension code.

Place nipy-io-overhaul up on lp/cburns for matthew reference.

Move header_utils, utils, analyze_to_nifti and sliceplot to
sandbox/tools.  Files are currently in
nipy-sandbox/neuroimaging/data_io/formats.

import neuroimaging.algorithms is very slow!  Find and fix.  The
shared library is slow.

Auto backup script for nipy repos to run as weekly cron job.  Chris
will run this on his machine.

Update import statements to match scipy/numpy standards::

  import numpy as np

Get nifticlib to support bz2.

